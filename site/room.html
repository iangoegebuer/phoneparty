<!doctype html>
<html>
  <head>
    <title>Phone Party</title>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <link href="site/css/site.css" rel="stylesheet" type="text/css">
  </head>
  <body>
    <h1 id="nameheader"></h1>
    <ul id="messages"></ul>
    <form action="">
      <input id="m" autocomplete="off" /><button>Send</button>
    </form>
    <script src="site/socket.io-1.3.7.js"></script>
    <script src="site/jquery-1.11.1.js"></script>
    <script src="site/js/util.js"></script>
    <script src="site/js/api.js"></script>
    <script src="site/js/game.js"></script>
    <script>
    var gameRoom = new Room();
    window.gameRoom = gameRoom;
    gameRoom.setUp();
    var game = new gameBase(gameRoom);
    gameRoom.setGame(game);

    gameRoom.game.setHandler('to everyone',function(msg) {
      $('#messages').append($('<li>').text(msg));
    });

    gameRoom.game.setHandler('set playerID',function(id) {
      console.log(id);
      $('#nameheader').text('Name: ' + gameRoom.name + ' (playerID: ' + gameRoom.playerID + ')');
    });

    $('form').submit(function(){
      //socket.emit('chat message with ack', $('#m').val(), function(data){
      //  $('#messages').append($('<li>').text('ACK CALLBACK: ' + data));
      //});
      gameRoom.socket.emit('to everyone', gameRoom.name + ": " + $('#m').val());
      gameRoom.socket.emit('sync var','lastMessage', gameRoom.name + ": " + $('#m').val())

      $('#m').val('');
      return false;
    });

    </script>
  </body>
</html>
